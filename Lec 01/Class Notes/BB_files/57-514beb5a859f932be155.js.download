(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{"In/i":function(module,exports){!function(){if(!window.WL&&!window.OneDrive){function t(e,t){var n=this,i=e[Pg];n._internalApp=WL.UnitTests&&typeof i===lb?i:a,n._options=e,n._method=t}window.OneDrive={},OneDrive.Constants={WebViewLink:Ib,DownloadLink:yc},OneDrive.open=function(e){var n=new t(q(e),ih);try{n.initialize(),n.validateOpenParameters(),n.executeOpenOperation()}catch(e){n.processError(e,Fb)}},OneDrive.save=function(e){var n=new t(q(e),jh);try{n.initialize(),n.validateSaveParameters(),n.executeSaveOperation()}catch(e){n.processError(e,Fb)}},OneDrive.createOpenButton=function(e){var n=new t(q(e),Bd);try{n.initialize(),n.validateOpenParameters(),n.validateButtonParameters();var i=n.createButtonElement();return p(i,zb,(function(){n.executeOpenOperation()})),i}catch(e){return n.processError(e,Fb),null}},OneDrive.createSaveButton=function(e){var n=new t(q(e),Nf);try{n.initialize(),n.validateSaveParameters(),n.validateButtonParameters();var i=n.createButtonElement();return p(i,zb,(function(){n.executeSaveOperation()})),i}catch(e){return n.processError(e,Fb),null}},t.onloadInit=function(){cb((function(){for(var e=document.querySelectorAll(Zf),n=0;n<e.length;n++){var i=e[n];t.createButtonElement(i,Kb,Z);var o=new t({file:i.href},Ef);i.href="#",p(i,zb,(function(){return o.initialize(),o.executeSaveOperation(),!1}))}}))},t.createButtonElement=function(e,t,n){var i={};i[y]=t,i[w]=n;var o=zd(i,!0);return e.innerHTML=o.innerHTML,e.id=o.buttonId,e.title=o.buttonTitle,Ed(i,e),e},t.prototype={initialize:function(){var e=this;if(e._internalApp._status!==Kc){var t=Ph();if(!t)throw new Error(fg.replace(m,e._method));e._internalApp.appInit({client_id:t,interface_method:e._method}),Si("Picker SDK initialized with client_id: "+t,fc)}},executeOpenOperation:function(){var e=this,t=e._internalApp,n=e._method,i=e._options,o=i[ce],r=i[Pb],a=i[Sb],s={mode:pb,resourceType:Hb,select:i[oe]?Bc:V,linkType:o,interface_method:n};t.fileDialog(s).then((function(e){var t=e.apiResponse,i=o===yc,a={link:i?null:t.webUrl,values:[]},s=i?t.value:t.children&&t.children.length>0?t.children:[t];if(!s)throw new Error(E(xd,n,JSON.stringify(e)));for(var c=0;c<s.length;c++){var l=s[c],d=[],p=i?l["@content.downloadUrl"]:l.webUrl,h=l.thumbnails&&l.thumbnails[0];if(h)for(var f=0;f<re.length;f++)d.push(h[re[f]].url);a.values.push({fileName:l.name,link:p,linkType:o,size:l.size,thumbnails:d})}u(r,a)}),(function(t){t.error===ab?u(a):e.processError(t,Kd)}))},executeSaveOperation:function(){var e=this,t=e._internalApp,n=e._options,i=e._method,o=n[Be],r=n[Jc],a=ef;if(Bb(o))a=jd,r=r||Qh(o);else if(Di(o)&&(a=Tc,!r))throw Ob(Jc,i);var s=n[Pb],c=n[de],l=n[Sb],d={mode:ob,resourceType:Gb,select:V,interface_method:i,save_scenario:!0};t.fileDialog(d).then((function(n){var l,d=n.pickerResponse,p=n.apiResponse,h=t._browser.ie9;if(h)l=p.data&&p.data[0].id;else if(!(l=p.value&&p.value[0]&&p.value[0].id)||1!==p.value.length)throw new Error(E(xd,i,JSON.stringify(n)));var f=t.getAccessTokenForApi();switch(a){case Tc:case jd:if(h){var _=l.split(".");l=_.length>2?_[2]:"root"}var g={path:"drives/"+d.owner_cid+"/items/"+l+"/children",method:cd,use_vroom_api:!0,request_headers:[{name:ei,value:Eg},{name:ui,value:"bearer "+f},{name:Lc,value:t._appId},{name:Fc,value:E("{0}={1}",Mc,t._settings.sdk_version)}],response_headers:[Wc],json_body:{"@content.sourceUrl":o,name:r,file:{}},interface_method:i};t.api(g).then((function(t){var n=t[Nc];a!==Tc||n!==Fg&&n!==Ee?a===jd&&n===Vd?e.beginPolling(s,c,t[Wc],f):e.processErrorCallback(t,Cc):u(s)}),(function(t){e.processErrorCallback(t,Cc)}));break;case ef:var v;if(h)v=l;else v=A(bd(!0)+"drive/items/"+l+"/children/{0}/content?"+eh,{access_token:f});var b={path:v,element:o,use_vroom_api:!h,overwrite:Od,file_name:r,interface_method:i};t.upload(b).then((function(){u(s)}),(function(t){e.processErrorCallback(t,Cc)}),(function(e){u(c,e.progressPercentage)}));break;default:throw new Error(Hf.replace(m,i))}}),(function(t){t.error===ab?u(l):e.processError(t,Kd)}))},beginPolling:function(e,t,n,i){var o=this,r=ji,a=cf,s={path:A(n,{access_token:i}),method:dc,use_vroom_api:!0,response_headers:[Wc],interface_method:o._method},c=function(){o._internalApp.api(s).then((function(n){switch(n[Nc]){case Vd:u(t,n[kg]),a--||(r*=2,a=cf),S(c,r);break;case Ee:u(t,100),u(e);break;default:o.processErrorCallback(n,Ad)}}),(function(e){o.processErrorCallback(e,Ad)}))};S(c,r)},validateOpenParameters:function(){h(this._options,[{name:ce,type:b,optional:!0,defaultValue:Ib,allowedValues:[yc,Ib]},{name:oe,type:jb,optional:!0,defaultValue:!1},{name:Pb,type:e,optional:!1},{name:Sb,type:e,optional:!0}],this._method)},validateSaveParameters:function(){h(this._options,[{name:Jc,type:b,optional:!0},{name:Be,type:b,optional:!1},{name:Pb,type:e,optional:!0},{name:de,type:e,optional:!0},{name:Sb,type:e,optional:!0},{name:se,type:e,optional:!0}],this._method)},validateButtonParameters:function(){h(this._options,[{name:te,type:b,optional:!0,defaultValue:Ec,allowedValues:[Ec,mg]}],this._method)},createButtonElement:function(){var e=document.createElement("button"),n=this._method===Bd?W:Kb,i=this._options[te]===Ec?Z:qb;return t.createButtonElement(e,n,i)},processError:function(e,t){var n=E(Lh,this._method,t,JSON.stringify(e));return k(n,fc),n},processErrorCallback:function(e,t){u(this._options[se],this.processError(e,t))}};var Fi="download",f="interface_method",Jf="WL.Internal.jsonp.",ye=2e3,Lc="Application",ui="Authorization",ff="body",zh="json_body",r="callback",jc="code",ne="Content-Type",Q="element",Ze="error",cj="error_description",tb="file_name",Ah="file_input",dj="file_output",Qd="request_headers",jg="response_headers",Wc="Location",Le="logging",Zb="message",eb="method",J="overwrite",Od="rename",s="path",kg="percentageComplete",ei="Prefer",fi="pretty",Eg="respond-async",gi="result",Rg="save_scenario",Mc="SDK-Version",jj="status",Nc="http_status",fh="return_ssl_resources",bj="stream_input",hj="tracing",bb="use_vroom_api",Fc="X-RequestStats",kj="error",Vd=202,Fg=201,Ee=200,Xi=500,fj="success",ge="suppress_redirects",eg="suppress_response_codes",N="x_http_live_library",af=0,Kc=1,d="access_token",Gi="appstate",Hi="authentication_key";AK_AUTH_TOKEN="authentication_token",AK_CLIENT_ID="client_id",AK_DISPLAY="display",AK_CODE="code",AK_ERROR="error",AK_ERROR_DESC="error_description",AK_EXPIRES="expires",AK_EXPIRES_IN="expires_in",AK_ITEMID="item_id",AK_LOCALE="locale",AK_OWNER_CID="owner_cid",AK_REDIRECT_URI="redirect_uri",AK_RESPONSE="response",AK_RESPONSE_TYPE="response_type",AK_REQUEST_TS="request_ts",AK_RESOURCEID="resource_id",AK_SCOPE="scope",AK_SESSION="session",AK_SECURE_COOKIE="secure_cookie",AK_STATE="state",AK_STATUS="status";var ic=[d,AK_AUTH_TOKEN,AK_SCOPE,AK_EXPIRES_IN,AK_EXPIRES],D="connected",li="notConnected",R="unchecked",Db="unknown",tc="expiring",pj="expired",nj="live-sdk-upload",ij="live-sdk-download",Pi="appId",Bi="channelUrl",vf="wl_auth",kf="wl_upload",nf="page",kd="touch",rc="none",We="none",cc="auth.login",Zc="auth.logout",X="auth.sessionChange",Hc="auth.statusChange",Af="wl.log",ab="access_denied",Jg="connection_failed",Kh="invalid_cookie",gh="invalid_request",xb="request_canceled",z="request_failed",kc="timed_out",gj="unknown_user",ej="user_canceled",xg="METHOD: Failed to get the required user permission to perform this operation.",yg="The request could not be completed due to browser issues.",Xd="The request could not be completed due to browser limitations.",Vf="The request could not be completed since the browser or browser version is not supported.",ag="Callback has thrown an exception. Exception message: MESSAGE",ac="METHOD: The operation has been canceled.",Sd="The 'wl_auth' cookie is not valid.",Jd="The 'wl_auth' cookie has been modified incorrectly. Ensure that the redirect URI only modifies sub-keys for values received from the OAuth endpoint.",Rf="The 'wl_auth' cookie has multiple values. Ensure that the redirect URI specifies a cookie domain and path when setting cookies.",Ug="METHOD: The input property 'PARAM' does not reference a valid DOM element.",ph="METHOD: An exception was received for EVENT. Detail: MESSAGE",Vg="METHOD: The WL object must be initialized with WL.init() prior to invoking this method.",be="A connection to the server could not be established.",Wi="The user could not be identified.",Wg="METHOD: Failed to get upload_location of the resource.",Kg="The pending login request has been canceled.",Wf="Logging out the user is not supported in current session because the user is logged in with a Microsoft account on this computer. To logout, the user may quit the app or log out from the computer.",Yd="METHOD: The input value for parameter/property 'PARAM' is not valid.",zg="METHOD: The input parameter/property 'PARAM' must be included.",bg="METHOD: The type of the provided value for the input parameter/property 'PARAM' is not valid.",xc="METHOD: There is a pending METHOD request, the current call will be ignored.",Pf=xc.replace(/METHOD/g,L),Ff=xc.replace(/METHOD/g,ub),Ui=xc.replace(/METHOD/g,Se),Xf="METHOD: The input property 'redirect_uri' is required if the value of the 'response_type' property is 'code'.",Mf="WL.init: The redirect_uri value should be the same as the value of 'Redirect Domain' of your registered app. It must begin with 'http://' or 'https://'.",Vi="METHOD: The api call is not supported on this platform.",Ti="WL.init: The response_type value 'code' is not supported on this platform.",Mh="METHOD: The input property 'redirect_uri' must use https: to match the scheme of the current page.",Ag="The auth request is timed out.",Xg="The popup is closed without receiving consent.",ad=0,sg=1,Zd=2,Oh=3,dc="GET",cd="POST",qi="PUT",Sh="DELETE",lj="COPY",mj="MOVE",ub="WL.fileDialog",lc="WL.api",rb="WL.download",ec="WL.init",L="WL.login",pc="WL.ui",Se="WL.upload",Ng=3e4,m="METHOD",Eb="PARAM",n="onSuccess",o="onError",G="onProgress",qc="redirect_type",Je="auth",ue="upload",Th="code",sb="token",sc="https:",pd="http:",pf="wl.signin",yi="wl.skydrive",mh="wl.skydrive_update",bi=/\s|,/,jb="boolean",uc="dom",e="function",wf="number",lb="object",gc="properties",b="string",Yb="string_or_array",hb="undefined",Qi="url",Ei="name",fb="element",mc="brand",nd="type",Tb="sign_in_text",Qb="sign_out_text",w="theme",De="onloggedin",we="onloggedout",yb="onerror",Uh="messenger",ki="hotmail",ci="skydrive",dd="windows",ve="windowslive",md="none",td="signin",Pc=td,xe="login",le="connect",qe="custom",Z="blue",qb="white",df="id",hc="onedrive_api",oc="auth_server",wb="apiservice_uri",Ab="skydrive_uri",T="sdk_root",vc="wl_trace";window.WL={getSession:function(){try{return a.getSession()}catch(e){k(e.message)}},getLoginStatus:function(){try{return a.getLoginStatus({callback:He(arguments,e,2),internal:!1},He(arguments,jb,2))}catch(e){return H("WL.getLoginStatus",e)}},logout:function(e){try{return nc(e,M,"WL.logout"),a.logout({callback:e})}catch(e){return H("WL.logout",e)}},canLogout:function(){return a.canLogout()},api:function(){try{var e=kh(arguments);return h(e,[{name:s,type:b,optional:!1},{name:eb,type:b,optional:!0},M],lc),a.api(e)}catch(e){return H(lc,e)}}};var jf=[cc,Zc,X,Hc,Af];WL.Event={subscribe:function(e,t){try{nc([e,t],[{name:"event",type:b,allowedValues:jf,caseSensitive:!0,optional:!1},pg],"WL.Event.subscribe"),c.subscribe(e,t)}catch(e){k(e.message)}},unsubscribe:function(e,t){try{nc([e,t],[{name:"event",type:b,allowedValues:jf,caseSensitive:!0,optional:!1},M],"WL.Event.unsubscribe"),c.unsubscribe(e,t)}catch(e){k(e.message)}}},WL.Internal={};var c={subscribe:function(e,t){i("Subscribe "+e),c.getHandlers(e).push(t)},unsubscribe:function(e,t){i("Unsubscribe "+e);var n=c.getHandlers(e),o=[];if(null!=t)for(var r=!1,a=0;a<n.length;a++)r||n[a]!=t?o.push(n[a]):r=!0;c._eHandlers[e]=o},getHandlers:function(e){c._eHandlers||(c._eHandlers={});var t=c._eHandlers[e];return null==t&&(c._eHandlers[e]=t=[]),t},notify:function(e,t){i("Notify "+e);for(var n=c.getHandlers(e),o=0;o<n.length;o++)n[o](t)}},a={_status:af,_statusRequests:[],_rpsAuth:!1};function B(e){if(a._status===af)throw new Error(Vg.replace(m,e))}function sd(){return WL.Internal.tApp||a}a.appInit=function(e){var t=e[f]||ec;if(a._status==Kc){var n=a._session.getNormalStatus();return Y(t,!0,e.callback,n)}var i=WL[T];i&&("/"!==i.charAt(i.length-1)&&(i+="/"),a[T]=i);var o=e[Le];return!1===o&&(a._logEnabled=o),a.testInit&&a.testInit(e),a._status=Kc,Gg(e)},a.onloadInit=function(){vi(),xi()},a.api=function(e){B(lc);var t=e[ff];t&&delete(e=q(hd(t),e))[ff];var n=e[eb];return e[eb]=(null!=n?U(n):dc).toUpperCase(),new xf(e).execute()},a.getAccessTokenForApi=function(){var e=null;if(!a._rpsAuth){var t=sd()._session.getStatus();t.status!==tc&&t.status!==D||(e=t.session[d])}return e};var rh=function(){var e,t=a.api.lastId;return e="WLAPI_REQ_"+(t=void 0===t?1:t+1)+"_"+(new Date).getTime(),a.api.lastId=t,e},xf=function(e){var t=this;t._properties=e,t._completed=!1,t._id=rh(),e[fi]=!1,e[fh]=a._isHttps,e[N]=a[N];var n=e[s],i=e[bb];t._url=Bb(n)?n:bd(i)+("/"===n.charAt(0)?n.substring(1):n),t._promise=new l(lc,null,null)};function Yc(e,t,n,i,o){var r=""!==(n=n?U(n):"")?ed(n):null;null===r&&(r={},2!==Math.floor(t/100)&&(r[Ze]=Vh(t,i))),o&&o.forEach((function(e){r[e.name]=e.value})),r[Nc]=t,e.onCompleted(r)}function Vh(e,t){var n={};return n[jc]=z,n[Zb]=t||be,n}function hd(e){var t={};for(var n in e){var i=e[n],o=typeof i;if(i instanceof Array)for(var r=0;r<i.length;r++){var a=i[r];if(o!=lb||i instanceof Date)t[n+"."+r]=a;else{var s=hd(a);for(var c in s)t[n+"."+r+"."+c]=s[c]}}else if(o!=lb||i instanceof Date)t[n]=i;else{var l=hd(i);for(var u in l)t[n+"."+u]=l[u]}}return t}function wh(e){if(!Oi())return!1;var t=Te(e),n=new XMLHttpRequest;return n.open(t.method,t.url,!0),t.requestHeaders.forEach((function(e){n.setRequestHeader(e.name,e.value)})),n.onreadystatechange=function(){if(4===n.readyState){var i=[];t.responseHeaders.forEach((function(e){i.push({name:e,value:n.getResponseHeader(e)})})),Yc(e,n.status,n.responseText,null,i)}},n.send(t.body),!0}function Te(e){var t=e._url,n=e._properties[eb],i=a.getAccessTokenForApi(),o=null,c=Ne(e._properties,null,[r,s,eb]),l=c[Qd]||[],u=c[jg]||[],p=c[zh],h=c[bb];switch(c[ge]="true",i&&(c[d]=i),h||A(t,{ts:(new Date).getTime(),method:n}),n){case dc:case Sh:h||A(t,c);break;default:o=h?JSON.stringify(p):K(c),l.push({name:ne,value:"application/"+(p?"json":"x-www-form-urlencoded")})}return{url:t,method:n,requestHeaders:l,responseHeaders:u,body:o}}function he(e,t){var n=t||{},i=bd();Bb(e)||(e=i+("/"===e.charAt(0)?e.substring(1):e));var o=a.getAccessTokenForApi();return o&&(n[d]=o),n[N]=a[N],A(e,n)}xf.prototype={execute:function(){return Yh(this),this._promise},onCompleted:function(e){this._completed||(this._completed=!0,v(this._properties.callback,e,!0),e[AK_ERROR]?this._promise[o](e):this._promise[n](e))}},a.download=function(e){return ng(e),B(rb),new Pe(e).execute()};var Id="notStarted",ie="ready",wc="downloadCompleted",Fd="downloadFailed",Rd="canceled",lg="completed";function Pe(e){this._properties=e,this._status=Id}function Zg(e,t){a._pendingLogin=null,t[AK_ERROR]?nb(L+": "+t[AK_ERROR_DESC]):v(e.callback,t,!0)}function Ae(e){var t=e||"";return t instanceof Array&&(t=t.join(" ")),U(t)}function ug(e,t){var n=a._statusRequests;a._pendingStatusRequest=null,i("wl_app:onGetLoginStatusCompleted");for(var o=t[AK_ERROR],r=!1;n.length>0;){var s=n.shift(),c=q(t);o&&!s.internal||v(s.callback,c,!0),s.internal||(r=!0)}o&&(r&&o!==kc?nb("WL.getLoginStatus: "+t[AK_ERROR_DESC]):i("wl_app-onGetLoginStatusCompleted: "+t[AK_ERROR_DESC]))}function Og(e){var t=e[Ah],n=e[tb];t&&(e[tb]=n||t.name)}function cg(e,t,n){var i=e.indexOf("?"),o=-1!==i,r="";o&&(r=e.substring(i+1),e=e.substring(0,i));var a=typeof t!==hb,s="/"===e.charAt(e.length-1);a&&!s&&(e+="/");var c=e,l={};return a&&(c+=encodeURIComponent(t)),l[J]=n===Od?"choosenewname":n,o&&(c=Me(c,r)),Gc(c,l)}function Ki(e){return/^(file|\/file)/.test(e.toLowerCase())}function Gc(e,t){return(t=t||{})[eg]="true",he(e,t)}function Sf(e){if(J in e){var t=e[f],n=e[J],i=typeof n,o=i===b;if(!(i===jb)&&!o)throw I(J,t);if(o)if(!/^(true|false|rename)$/i.test(n))throw O(J,t)}else e[J]=!1}Pe.prototype={execute:function(){return this._promise=new l(rb,this,null),this._process(),this._promise},cancel:function(){if(this._status=Rd,this._cancel)try{this._cancel()}catch(e){}else this._result=j(xb,ac.replace(m,rb)),this._process()},downloadComplete:function(e,t){var n=this;n._result=t,n._status=e?wc:Fd,n._process()},downloadProgress:function(e){this._promise[G](e)},_process:function(){switch(this._status){case Id:this._start();break;case ie:this._download();break;case wc:case Fd:case Rd:this._complete()}},_start:function(){var e=this;a.getLoginStatus({internal:!0,callback:function(){e._status=ie,e._process()}})},_download:function(){oi(this)},_complete:function(){var e=this,t=e._result,i=e._status===wc?n:o;e._status=lg;var a=e._properties[r];a&&a(t),e._promise[i](t)}},a.login=function(e,t,n){if(B(L),Bh(e),!Rh(t))return Y(L,!1,null,j(z,Pf));var i=a._session.tryGetResponse(e.normalizedScope);return null!=i?Y(L,!0,e.callback,i):(a._pendingLogin=Jh(e,Zg,n),a._pendingLogin.execute())},a.getSession=function(){return B("WL.getSession"),a._session.getStatus()[AK_SESSION]},a.getLoginStatus=function(e,t){if(B("WL.getLoginStatus"),e=e||{},!t){var n=a._session.tryGetResponse();if(n)return Y("WL.getLoginStatus",!0,e.callback,n)}i("wl_app:getLoginStatus");var o=a._statusRequests,r=null;return a._pendingStatusRequest||(r=wg(e,ug),a._pendingStatusRequest=r),o.push(e),null!=r&&r.execute(),a._pendingStatusRequest._promise},a.logout=function(e){var t="WL.logout";B(t);var i=new l(t,null,null),r=function(r){S((function(){var s,c=n;r?(k(r.message),c=o,s=Nb(t,t,r)):s=a._session.getNormalStatus(),v(e.callback,s,!1),i[c](s)}))},s=function(){var e=a._session;e.isSignedIn()?a.canLogout()?(e.updateStatus(Db),Zh(r)):r(new Error(Wf)):r()};return null!=a._pendingStatusRequest?a.getLoginStatus({internal:!0,callback:s},!1):s(),i},a.upload=function(e){var t=e[f];return B(t),h(e,[{name:s,type:b,optional:!1},M],t),Sf(e),Og(e),new fd(e).execute()};var Ud=0,ae=1,Dc=2,Ac=3,Jb=4,ee=5,Dg=6;function fd(e){this._props=e,this._status=Ud}fd.prototype={execute:function(){var e=this;return e._strategy=e._getStrategy(e._props),e._promise=new l(e._props[f],e,null),e._process(),e._promise},cancel:function(){var e=this;if(e._status=ee,e._cancel)try{e._cancel()}catch(e){}else{var t=ac.replace(m,e._props[f]);e._result=j(xb,t),e._process()}},uploadProgress:function(e){this._promise[G](e)},uploadComplete:function(e,t){var n=this;n._result=t,n._status=e?Ac:Jb,n._process()},onErr:function(e){var t=this._props[f]+":"+e,n=j(z,t);this.uploadComplete(!1,n)},onResp:function(e){var t=""!==(e=e?U(e):"")?ed(e):null;t=t||{},this.uploadComplete(null==t.error,t)},setFileName:function(e){this._props[tb]=e},_process:function(){switch(this._status){case Ud:this._start();break;case ae:this._getUploadPath();break;case Dc:this._upload();break;case Ac:case Jb:case ee:this._complete()}},_start:function(){var e=this;sd().getLoginStatus({internal:!0,callback:function(){e._status=ae,e._process()}})},_getUploadPath:function(){var e=this,t=e._props,n=t[s];if(Bb(n))return e._uploadPath=t[bb]?n:Gc(n),e._status=Dc,void e._process();sd().api({path:n}).then((function(i){var o=i.upload_location;if(o){o=Me(o,ii(n));var r=t[tb],a=t[J];Ki(n)?e._uploadPath=Gc(o):e._uploadPath=cg(o,r,a),e._status=Dc}else e._result=j(z,Wg.replace(m,t[f])),e._status=Jb;e._process()}),(function(t){e._result=t,e._status=Jb,e._process()}))},_upload:function(){this._strategy.upload(this._uploadPath)},_complete:function(){var e=this,t=e._result,i=e._status===Ac?n:o;e._status=Dg;var a=e._props[r];a&&a(t),e._promise[i](t)}};var vh=new RegExp("^\\w+\\.\\w+:\\w+[\\|\\w+]+:([\\w]+\\!\\d+)(?:\\!(.+))*");function U(e){return e.replace(/^\s+|\s+$/g,"")}function Td(e,t){return e&&t?e.toLowerCase()===t.toLowerCase():e===t}function Ce(e){return null==e||""===e}function E(){var e=arguments;return e[0].replace(/\{\d+\}/g,(function(t){return e[parseInt(t.replace(/[\{\}]/g,""))+1]||""}))}var yf="0000000000000000";function Li(e){return yf.substring(0,yf.length-e.length)+e}function rd(e){var t={c:0,s:-1};return e.replace(/[^\w .,-]/g,(function(e,n,i){return Nh(i,n,t)?["&#",t.c,";"].join(""):""}))}function Nh(e,t,n){var i=n.s===t;if(!i){t=t||0;var o,r,a=e.charCodeAt(t);n.s=-1,a<55296||a>57343?n.c=a:a<=56319?(o=a,r=e.charCodeAt(t+1),n.c=1024*(o-55296)+(r-56320)+65536,n.s=t+1):(n.c=-1,i=!0)}return!i}function q(e,t){var n=t||{};if(null!=e)for(var i in e)n[i]=e[i];return n}function Ne(e,t,n){for(var i=q(e,t),o=0;o<n.length;o++)delete i[n[o]];return i}function Ai(e,t){var n;for(n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}function zf(e){return Array.prototype.slice.call(e)}function g(t,n){return function(){if(typeof n===e)return n.apply(t,arguments)}}function Cf(e,t,n){e=(n=n||"[WL]")+e;var i=window;i.debugLogger&&i.debugLogger.push(e);var o=i.console;if(o&&o.log)switch(t){case"warning":o.warn(e);break;case"error":o.error(e);break;default:o.log(e)}var r=i.opera;r&&r.postError(e);var a=i.debugService;a&&a.trace(e)}function Bb(e){return 0===e.indexOf("https://")||0===e.indexOf("http://")}function Di(e){return 0===e.indexOf("data:")}function i(e){a._traceEnabled&&Cf(e)}function nb(e,t,n){(a._logEnabled||a._traceEnabled)&&Cf(e,t,n),c.notify(Af,e)}function Si(e,t){nb(e,"text",t)}function k(e,t){nb(e,"error",t)}function Ge(e,t){var n=Ub("iframe");return n.id=t,n.src=e,document.body.appendChild(n),n}function Ub(e){var t=document.createElement(e);return t.style.position="absolute",t.style.top="-1000px",t.style.width="300px",t.style.height="300px",t.style.visibility="hidden",t}function Oc(){for(var e=null;null==e;)null!=gb(e="wl_"+Math.floor(1024*Math.random()*1024))&&(e=null);return e}function gb(e){return document.getElementById(e)}function zi(e,t){if(e)if(e.innerText)e.innerText=t;else{var n=document.createTextNode(t);e.innerHTML="",e.appendChild(n)}}function ii(e){var t=e.indexOf("?");if(-1===t)return"";var n=e.indexOf("#",t+1);return-1!==n?e.substring(t+1,n):e.substring(t+1)}function Me(e,t){return typeof t===hb||null===t||""===t?e:-1===e.indexOf("?")?e+"?"+t:("&"!==e.charAt(e.length-1)&&(e+="&"),e+t)}function wd(e){q(vd(e),this)}function vd(e){var t=0==e.indexOf(sc)?sc:0==e.indexOf(pd)?pd:"",n="",i="";if(""!=t)var o=e.substring(t.length+2),r=Xb(o.indexOf("/")),a=Xb(o.indexOf("\\")),s=Xb(o.indexOf("?")),c=Xb(o.indexOf("#")),l=Ih(Math.min(r,a,s,c)),u=(l>0?o.substring(0,l):o).split(":"),d=(n=u[0],i=u.length>1?u[1]:"",l>0?o.substring(l):"");else d=e;return{scheme:t,host:n,port:i,path:d}}function Xb(e){return-1==e?Number.POSITIVE_INFINITY:e}function Ih(e){return e==Number.POSITIVE_INFINITY?-1:e}function Ci(e){return vd(e.toLowerCase()).host}function Dh(e,t,n){var i=function(e,n){return charIdx=t.indexOf(n),e=charIdx>0?e.substring(0,charIdx):e},o=(t=i(i(t,"?"),"#")).indexOf(e),r=t.substring(o+e.length),a=r.indexOf("/"),s=r.lastIndexOf("/");return(r=s>=0?r.substring(a,s):r)+"/"+n}function rf(e){var t=e.indexOf("?");return t>0&&(e=e.substring(0,t)),(t=e.indexOf("#"))>0&&(e=e.substring(0,t)),e}function Qh(e){var t=rf(e),n=t.lastIndexOf("/")+1;return t.substr(n)}function u(e,t){v(e,t,!0)}function v(t,n,i){function o(){try{void 0!==n?t(n):t()}catch(e){throw k(ag.replace("MESSAGE",e.message)),e}}typeof t==e&&(i?o():S((function(){o()})))}function ed(e){return JSON.parse(e)}function Re(){return Math.floor((new Date).getTime()/1e3)}function Ri(e,t){for(var n=e.length,i=0;i<n;i++)t(e[i])}function mi(e,t){var n={};return n[AK_ERROR]=e,n[AK_ERROR_DESC]=t,n}function j(e,t){var n={},i={};return n[jc]=e,n[Zb]=t,i[Ze]=n,i}function Nb(e,t,n){return j(z,ph.replace("METHOD",e).replace("EVENT",t).replace("MESSAGE",n.message))}function dh(e){var t=e.split(".");return t[0]+"."+t[1]}function S(e,t){window.wlUnitTests?wlUnitTests.delayInvoke(e):window.setTimeout(e,t||1)}function vi(){var e=wi(navigator.userAgent,document.documentMode),t=a[N];a._browser=e,a[N]=t.replace("DEVICE",e.device)}function wi(e,t){e=e.toLowerCase();var n="other",i={firefox:/firefox/.test(e),"firefox1.5":/firefox\/1\.5/.test(e),firefox2:/firefox\/2/.test(e),firefox3:/firefox\/3/.test(e),firefox4:/firefox\/4/.test(e),ie:(/msie/.test(e)||/trident/.test(e))&&!/opera/.test(e),ie6:!1,ie7:!1,ie8:!1,ie9:!1,ie10:!1,ie11:!1,opera:/opera/.test(e),webkit:/webkit/.test(e),chrome:/chrome/.test(e),mobile:/mobile/.test(e)||/phone/.test(e)};if(i.ie){var o=0;t?o=t:/msie 7/.test(e)&&(o=7),i[n="ie"+(o=Math.min(11,Math.max(o,6)))]=!0}else i.firefox?n="firefox":i.chrome?n="chrome":i.webkit?n="webkit":i.opera&&(n="opera");return i.mobile&&(n+="mobile"),i.device=n,i}function Rb(e,t){var n=null!=t?t:{};if(null!=e)for(var i=e.split("&"),o=0;o<i.length;o++){var r=i[o].split("=");2==r.length&&(n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]))}return n}function K(e){var t="";if(null!=e)for(var n in e)if(e.hasOwnProperty(n)){var i=t.length?"&":"",o=e[n];t+=i+encodeURIComponent(n)+"="+encodeURIComponent(Eh(o))}return t}function Eh(e){if(e instanceof Date){var t=function(e,t){switch(t){case 2:return e<10?"0"+e:e;case 3:return(e<10?"00":e<100?"0":"")+e}};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1,2)+"-"+t(e.getUTCDate(),2)+"T"+t(e.getUTCHours(),2)+":"+t(e.getUTCMinutes(),2)+":"+t(e.getUTCSeconds(),2)+"."+t(e.getUTCMilliseconds(),3)+"Z"}return""+e}function ai(e){var t=e.indexOf("?")+1,n=e.indexOf("#")+1,i={};if(t>0){var o=n>t?n-1:e.length;i=Rb(e.substring(t,o),i)}return n>0&&(i=Rb(e.substring(n),i)),i}function A(e,t){return e+(e.indexOf("?")<0?"?":"&")+K(t)}function lh(e){switch(typeof e){case jb:return e;case wf:return!!e;case b:return"true"===e.toLowerCase();default:return!1}}window.WL&&WL.Internal&&(WL.Internal.trace=i,WL.Internal.log=nb),wd.prototype={toString:function(){var e=this;return(""!=e.scheme?e.scheme+"//":"")+e.host+(""!=e.port?":"+e.port:"")+e.path},resolve:function(){var e=this;if(""==e.scheme){var t=window.location.port,n=window.location.host;e.scheme=window.location.protocol,e.host=n.split(":")[0],e.port=null!=t?t:"","/"!=e.path.charAt(0)&&(e.path=Dh(e.host,window.location.href,e.path))}}};var M={name:r,type:e,optional:!0},pg={name:r,type:e,optional:!1};function nc(e,t,n){if(e instanceof Array)for(var i=0;i<e.length;i++)lf(e[i],t[i],n);else lf(e,t,n)}function lf(e,t,n){Ue(e,t,n),t.type===gc&&h(e,t.properties,n)}function Ue(t,n,i,o){var r=n.name,a=typeof t,s=n.type;if(a===hb||null==t){if(n.optional)return void(o&&o());throw Ob(r,i)}switch(s){case b:if(a!=b)throw I(r,i);if(!n.optional&&""===U(t))throw Ob(r,i);break;case Qi:if(a!=b||!Bb(t))throw I(a,i);break;case gc:if(a!=lb)throw I(r,i);break;case e:if(a!=e)throw I(a,i);break;case uc:if(a==b){if(null==gb(t))throw new Error(Ug.replace(m,i).replace(Eb,r))}else if(a!=lb)throw I(r,i);break;case Yb:if(a!=b&&!(t instanceof Array))throw I(a,i);break;default:if(a!=s)throw I(r,i)}null!=n.allowedValues&&xh(t,n.allowedValues,n.caseSensitive,r,i)}function h(e,t,n){for(var i=e||{},o=0;o<t.length;o++){var r=t[o];Ue(i[r.name]||i[r.altName],r,n,(function(){typeof r.defaultValue!=hb&&(i[r.name]=r.defaultValue)}))}}function xh(e,t,n,i,o){for(var r=typeof t[0]===b,a=0;a<t.length;a++)if(r&&!n){if(e.toLowerCase()===t[a].toLowerCase())return}else if(e===t[a])return;throw O(i,o)}function I(e,t){return new Error(bg.replace(m,t).replace(Eb,e))}function Ob(e,t){return new Error(zg.replace(m,t).replace(Eb,e))}function O(e,t,n){var i=Yd.replace(m,t).replace(Eb,e);return typeof n!==hb&&(i+=" "+n),new Error(i)}function He(e,t,n){if(e)for(var i=0;i<n&&i<e.length;i++)if(t===typeof e[i])return e[i]}function db(t,n){for(var i=zf(t),o=null,r=null,a=0;a<i.length;a++){var s=i[a],c=typeof s;c===lb&&null===o?o=q(s):c===e&&null===r&&(r=s)}return o=o||{},r&&(o.callback=r),o[f]=n,o}function kh(e){var t=zf(e),n=null,i=null;return typeof t[0]===b&&(n=t.shift(),typeof t[0]===b&&(i=t.shift())),normalizedArgs=db(t),null!==n&&(normalizedArgs[s]=n,null!=i&&(normalizedArgs[eb]=i)),normalizedArgs}function H(e,t){var n=Nb(e,e,t);return k(t.message),Y(e,!1,null,n)}var l=function(e,t,n){this._name=e,this._op=t,this._uplinkPromise=n,this._isCompleted=!1,this._listeners=[]};function Y(t,i,r,a){var s=new l(t,null,null),c=i?n:o;return typeof r===e&&s.then((function(e){r(e)})),S((function(){s[c](a)})),s}l.prototype={then:function(e,t,i){var r=new l(null,null,this),a={};return a[n]=e,a[o]=t,a[G]=i,a.chainedPromise=r,this._listeners.push(a),r},cancel:function(){this._isCompleted||(this._uplinkPromise&&!this._uplinkPromise._isCompleted?this._uplinkPromise.cancel():typeof(this._op?this._op.cancel:null)===e?this._op.cancel():this.onError(j(xb,ac.replace("METHOD",this._getName()))))},_getName:function(){return this._name?this._name:this._op&&typeof this._op._getName===e?this._op._getName():this._uplinkPromise?this._uplinkPromise._getName():""},_onEvent:function(e,t){this._isCompleted||(this._isCompleted=t!==G,this._notify(e,t))},_notify:function(e,t){var i=this;Ri(this._listeners,(function(r){var a=r[t],s=r.chainedPromise,c=t!==G;if(a)try{var l=a.apply(r,e);c&&l&&l.then&&(s._op=l,l.then((function(e){s[n](e)}),(function(e){s[o](e)}),(function(e){s[G](e)})))}catch(e){c&&s.onError(Nb(i._getName(),t,e))}else c&&s[t].apply(s,e)}))}},l.prototype[n]=function(){this._onEvent(arguments,n)},l.prototype[o]=function(){this._onEvent(arguments,o)},l.prototype[G]=function(){this._onEvent(arguments,G)};var ic=[d,AK_AUTH_TOKEN,AK_SCOPE,AK_EXPIRES_IN,AK_EXPIRES,AK_REQUEST_TS,AK_ERROR,AK_ERROR_DESC],Ye="refresh_type",yh="app",Uc="ms",Vc="response_method",fe="url",Pd="cookie",Wb="onanalytics",Fe="login",Wd="loginstatus",Hg="file_dialog",Vb="auth.response",Oe="client-id",Zf=".OneDriveSaveButton",ud="file",zb="click",qd="onedrive-js",ke="2px",Md="0px",ze="4px",fg="METHOD: Failed to initialize due to missing 'client-id'.",og="Loading OneDrive picker is timed out.",y="mode",W="open",Kb="save",pb="read",ob="readwrite",Mb="linkType",Hd="resourceType",Hb="file",Gb="folder",P="select",V="single",Bc="multi",hg="permission",Kf="onetime",Lb="lightbox",Yf="grey",yd="transparent",zc="white",Dd="loading_timeout",Ld="onselected",Sb="cancel",se="error",Be="file",Jc="fileName",Pg="internal_app",ce=Mb,yc="downloadLink",Ib="webViewLink",de="progress",oe="multiSelect",Pb="success",te="theme",Ec="blue",mg="white",jd="content_url",Tc="data_url",ef="form",Hf="METHOD: This upload method is not implemented.",Lh="{0}: Operation: '{1}' Error message: {2}",xd="{0}: Invalid response from the file picker. Response: {1}",aj="API call",Kd="invoke picker",Fb="unhandled exception",Cc="upload",Ad="upload: poll for completion",ih="OneDrive.open",jh="OneDrive.save",Bd="OneDrive.createOpenButton",Nf="OneDrive.createSaveButton",Ef="OneDriveApp.onloadInit",Zi="OneDriveApp.initialize",hh="auth",qg="rps",gg="oauth",rg="v",Gf="1",If="2",Lg="domain",Bg="livesdk",qh="mkt";FILEDIALOG_PARAM_PICKER_SCRIPT="pickerscript",FILEDIALOG_CHCMD_ONCOMPLETE="onPickerComplete",FILEDIALOG_CHCMD_UPDATETOKEN="updateToken";var Yg=104857600,Ji=27,ji=1e3,cf=5,fc="[OneDrive]",bc="skydrivepicker",eh="@name.conflictBehavior=rename",Qg="select=id,@content.downloadUrl,name,size&expand=thumbnails",Of="select=id,webUrl,name,size&expand=thumbnails,children(select=id,webUrl,name,size;expand=thumbnails)",ti="select=id",re=["large","medium","small"];function me(t,n){if(h(t,[{name:y,type:b,allowedValues:[W,Kb,pb,ob],optional:!1},{name:Hd,type:b,allowedValues:[Hb,Gb],optional:!0},{name:P,type:b,allowedValues:[V,Bc],optional:!0},{name:Lb,type:b,allowedValues:[Yf,yd,zc],optional:!0},{name:Dd,type:wf,optional:!0},{name:hg,type:b,allowedValues:[Kf],optional:!0},M],n),n!==ub&&h(t,[{name:w,allowedValues:[Z,qb],type:b,optional:!0},{name:Ld,type:e,optional:!1},{name:yb,type:e,optional:!0}],n),!gd.isSupported()||!window.JSON||a._browser.mobile)throw new Error(Xd)}function uh(){a._urlParams=ai(window.location.href),a._pageState=Rb(a._urlParams[AK_STATE])}function Ke(){var e=new Cb(vf);e.load();var t=a._urlParams,n=a._pageState,i=!0,o=n[AK_REQUEST_TS];o&&(o!=e.get(AK_REQUEST_TS)?e.set(AK_REQUEST_TS,n[AK_REQUEST_TS]):i=!1);var r=null!=t[d],s=null!=e.get(d)||r,c=s?D:Db,l=Re();if(n[Vc]===fe){for(var u=0;u<ic.length;u++){var p=ic[u];t[p]&&e.set(p,t[p])}r?(e.set(AK_EXPIRES,l+parseInt(t[AK_EXPIRES_IN])),e.remove(AK_ERROR),e.remove(AK_ERROR_DESC)):s||t[AK_ERROR]===ab&&(c=li)}else{if(!i)return;var h=Ig(e);h&&(e.set(AK_ERROR,Kh),e.set(AK_ERROR_DESC,h))}e.set(AK_STATUS,c),e.save()}function hi(){var t=a._pageState;if(t[qc]!==ue){var n=t[AK_DISPLAY],i="true"===t[AK_SECURE_COOKIE];if(a._logEnabled=!0,a._traceEnabled=t[vc]||a._urlParams[vc],a._secureCookie=i,Tg(),n===nf||n===kd)if(Ke(),n===kd&&a._browser.ie){var o=t[AK_REDIRECT_URI];Fh(o),document.location=o}else window.close();else if(n===rc)Ke();else{cb(ri);var r=window.wlAsyncInit;r&&typeof r===e&&r.call()}}else{sh(t[df],a._urlParams[gi])}}function Fh(e){if(null!=e){var t=new wd(e);if(""!=t.scheme){var n=window.location.host,i=t.host;if(i==n)return;if(n="."+n,-1!==i.indexOf(n,i.length-n.length))return}throw new Error(Mf.replace("WL.init","WL.login"))}}function th(e,t){return e||(e=rf(window.location.href)),Lf(e,window.location.hostname,t)}function Lf(e,t,n){var i=new wd(e);i.resolve();t=t.split(":")[0].toLowerCase();var o=i.host.toLowerCase();if(a._domain=a._domain||o,a._isHttps&&i.scheme==pd)throw new Error(Mh.replace("METHOD",n));return i.toString()}function Ig(e){var t=null!=e.get(d),n=null!=e.get(AK_ERROR),i=null!=e.get(AK_SCOPE),o=null!=e.get(AK_EXPIRES_IN),r=null!=e.get(AK_CLIENT_ID),a=null;return t&&i&&o||n||(k(Sd),a=Sd),r||(k(Jd),a=Jd),a}function xi(){ye=a._browser.ie?2e3:4e3,uh(),hi()}function sh(e,t){var n=new Cb(kf);n.load(),n.set(e,t),n.save()}function Gg(e){a._authScope=Ae(e[AK_SCOPE]),a._secureCookie=lh(e[AK_SECURE_COOKIE]),a._redirect_uri=th(e[AK_REDIRECT_URI],ec),a._response_type=(e[AK_RESPONSE_TYPE]||sb).toLowerCase(),a._appId=e[AK_CLIENT_ID],a._refreshType=(e[Ye]||Uc).toLowerCase();var t=new sf(e[AK_CLIENT_ID],vf);a._session=t;var i,r=t.getNormalStatus(),s=r[AK_STATUS],u=ec;return s==D?(c.notify(X,r),c.notify(Hc,r),c.notify(cc,r),i=Y(u,!0,e.callback,r)):e[AK_STATUS]&&(i=new l(u,null,null),a.getLoginStatus({internal:!0,callback:function(e){var t=e.error?o:n;i[t](e)}},!0)),i}function Rh(){var e=a._pendingLogin;return null!=e&&(e.cancel(),a._pendingLogin=null),!0}function Bh(e){var t=Ae(e[AK_SCOPE]);if(""===t&&(t=a._authScope),!t||""===t)throw Ob(AK_SCOPE,L);e.normalizedScope=t}function Jh(e,t,n){return new od(Fe,e,t,n)}function wg(e,t){return new od(Wd,e,t)}function Zh(e){Ve();var t=Ub("iframe"),n=Qe();t.src="//"+n+"/oauth20_logout.srf?ts="+(new Date).getTime();var i=function(){Ve(e)};t.attachEvent?t.attachEvent("onload",i):t.onload=i,document.body.appendChild(t),a.logoutFrame=t,window.setTimeout(i,3e4)}function Ve(e){null!=a.logoutFrame&&(document.body.removeChild(a.logoutFrame),a.logoutFrame=null,e&&e())}function je(e,t){k(t.message);var n=e[yb];n&&S((function(){error=Nb(pc,pc,t),n(error)}))}function gf(){return a[T]}function of(){return gf()+"images"}WL.init=function(e){try{var t=q(e),n=ec;if(nc(t,{name:gc,type:gc,optional:!1,properties:[{name:AK_CLIENT_ID,altName:Pi,type:b,optional:!1},{name:AK_SCOPE,type:Yb,optional:!0},{name:AK_REDIRECT_URI,altName:Bi,type:b,optional:!0},{name:AK_RESPONSE_TYPE,type:b,allowedValues:[Th,sb],optional:!0},{name:Ye,type:b,allowedValues:[yh,Uc],optional:!0},{name:Le,type:jb,optional:!0},{name:AK_STATUS,type:jb,optional:!0}]},n),!t[AK_REDIRECT_URI]&&t[AK_RESPONSE_TYPE]===AK_CODE)throw new Error(Xf.replace(m,n));return null==t[AK_STATUS]&&(t[AK_STATUS]=!0),a.appInit(t)}catch(e){return H(n,e)}},WL.login=function(){try{var e=db(arguments),t=L;return h(e,[{name:AK_SCOPE,type:Yb,optional:!0},{name:AK_REDIRECT_URI,type:b,optional:!0},{name:AK_STATE,type:b,optional:!0},M],t),a.login(e)}catch(e){return H(t,e)}},WL.download=function(){try{var e=rb,t=db(arguments,e);return a.download(t)}catch(t){return H(e,t)}},WL.upload=function(){try{var e=Se,t=db(arguments,e);return a.upload(t)}catch(t){return H(e,t)}},WL.ui=function(){try{var e=db(arguments);h(e,[{name:Ei,type:b,allowedValues:[td,bc],optional:!1},M],pc),a.ui(e)}catch(t){je(e,t)}},WL.fileDialog=function(){try{var e=ub,t=db(arguments,e);return me(t,e),a.fileDialog(t)}catch(t){return H(e,t)}},a.ensurePermission=function(e,t,n,i){var o=j(ab,xg.replace("METHOD",n));a.login({scope:e}).then((function(n){n.session[AK_EXPIRES_IN]<t?a.getLoginStatus({internal:!0},!0).then((function(){a.login({scope:e}).then((function(e){i(e)}),(function(){i(o)}))}),(function(){i(o)})):i(n)}),(function(){i(o)}))},a.canLogout=function(){return!0};var ld=function(e){var t=this;t._properties=e,cb(g(t,t.init))};function ig(e){a._authScope&&""!==a._authScope&&(e[AK_SCOPE]=a._authScope),e[AK_SCOPE]||(e[AK_SCOPE]=pf)}function Qf(e,t,n){t._handlers=t._handlers||{};var i=g(t,n);return t._handlers[e]=i,i}function dg(e,t){return t._handlers[e]}function Df(e){h(e,[{name:w,allowedValues:[Z,qb],type:b,optional:!0},{name:mc,allowedValues:[Uh,ki,ci,dd,ve,md],type:b,optional:!0}],"WL.ui-signin"),e[w]=e[w]||Z,e[mc]=e[mc]||dd}function Sg(e){var t=e[mc],n=e[w],i=a._locale,o=i.indexOf("ar")>-1||i.indexOf("he")>-1?"RTL":"LTR",r="margin:0px;padding:0px;border-width:0px;vertical-align:middle;background-attachment:scroll;display:inline-block;white-space:nowrap;",s=Sc(t,o,n,"left")+r,c=Sc(t,o,n,"center")+r,l=Sc(t,o,n,"right")+r;return'<button style="cursor:pointer;background-color:transparent;border:solid 0px;display:inline-block;overflow:hidden;white-space:nowrap;padding:0px;width:auto;"><span style="'+s+'"></span><span style="'+c+'"><span style="'+tg(o)+'"></span></span><span style="'+l+'"></span></button>'}function tg(e){var t=a._browser,n=t.ie6||t.ie7,i=(t.ie8||t.ie9,t.chrome||t.safari?"padding:2px 3px;margin:0px;":"padding:1px 3px;margin:0px;"),o="direction:"+e.toLowerCase()+";",r="150";switch(a._locale){case"ar-ploc-sa":n||(r="170");break;case"te":case"ja-ploc-jp":t.ie&&(r="190")}return i+o+"text-decoration:none;color:#3975a0;display:inline-block;font-family: Segoe UI, Verdana, Tahoma, Helvetica, Arial, sans-serif;"+("height:18px;font-size:9pt;font-weight:bold;line-height:"+r+"%;")}function Sc(e,t,n,i){var o,r,a,s=(e=e==dd?ve:e)+"_"+t+"_"+n;switch(i){case"left":o=e===md||"RTL"===t?"3px":"25px",r="LTR"===t?"0px":"-44px",a="no-repeat";break;case"center":o="auto",r="-22px",a="repeat-x";break;case"right":o=e===md||"LTR"===t?"3px":"25px",r="LTR"===t?"-44px":"0px",a="no-repeat"}return"background: url({imgpath}/signincontrol/{image}.png) scroll {repeat} 0px {vpos}; height: 22px; width: {width};".replace("{imgpath}",of()).replace("{image}",s).replace("{vpos}",r).replace("{width}",o).replace("{repeat}",a)}function Tf(e,t){e._button=t,p(t,"click",Qf("click",e,e.onClick))}function Gd(e){var t=e._button;t&&(C(t,"click",dg("click",e)),delete e._button)}ld.prototype={init:function(){var e=this,t=e._properties;if(!0!==e._inited){e._inited=!0;try{e.validate();var n=t[fb],i=t[nd],o=t[r],s=t[Tb],l=t[Qb];ig(t),n=typeof n===b?gb(t[fb]):n,e._element=n,(i=null!=i?i:Pc)==Pc?(s=x.signIn,l=x.signOut):i==xe?(s=x.login,l=x.logout):i==le&&(s=x.connect,l=x.signOut),e[Tb]=s,e[Qb]=l,qf(n,Sg(t));var u=a._session.isSignedIn(),d=u?l:s;e.updateUI(d,u),Tf(e,n.childNodes[0]),c.subscribe(cc,g(e,e.onLoggedIn)),c.subscribe(Zc,g(e,e.onLoggedOut)),a.getLoginStatus({internal:!0}),delete t[r],v(o,t,!1)}catch(e){je(t,e)}}},validate:function(){var t=this._properties;h(t,[{name:fb,type:uc,optional:!1},{name:nd,allowedValues:[Pc,xe,le,qe],type:b,optional:!0},{name:AK_SCOPE,type:Yb,optional:!0},{name:AK_STATE,type:b,optional:!0},{name:De,type:e,optional:!0},{name:we,type:e,optional:!0},{name:yb,type:e,optional:!0}],"WL.ui-signin"),Df(t),t[nd]==qe&&h(t,[{name:Tb,type:b,optional:!1},{name:Qb,type:b,optional:!1}],"WL.ui-signin")},fireEvent:function(e,t){var n=this._properties[e];n&&n(t)},onClick:function(){var e=this;return 0==e._element.childNodes.length?(Gd(e),!1):(a._session.isSignedIn()?a.canLogout()&&a.logout({}):a.login(e._properties,!0).then((function(){}),(function(t){e.fireEvent(yb,t)})),!1)},onLoggedIn:function(e){this.updateUI(this[Qb],!0),this.fireEvent(De,e)},onLoggedOut:function(e){this.updateUI(this[Tb],!1),this.fireEvent(we,e)}},a.ui=function(e){switch(B(pc),e.name){case td:new ld(e);break;case bc:new pe(e)}},ld.prototype.updateUI=function(e){if(0!=this._element.childNodes.length){if(e!=this._text){var t=a._browser,n=this._element.childNodes[0],i=n.childNodes[1];if(zi(i.childNodes[0],e),this._text=e,t.ie6||t.ie7){i.style.width="auto",n.style.width="auto";var o=n.childNodes[0].clientWidth,r=n.childNodes[1].clientWidth,s=n.childNodes[2].clientWidth,c=o+r+s;n.style.width=c+"px",t.ie6&&(n.childNodes[0].style.width=o+"px",n.childNodes[1].style.width=r+"px",n.childNodes[2].style.width=s+"px")}}}else Gd(this)};var pe=function(e){me(e);var t=this;t._props=e,cb(g(t,t.init))};function Ed(e,t){var n=e[w]===qb,i=a._locale,o=i.indexOf("ar")>-1||i.indexOf("he")>-1,r=o?"RTL":"LTR",s=t.childNodes[0],c=t.childNodes[1],l="#094AB2",u="#ffffff",d=t.style,p=s.style,h=c.style;d.direction=r,d.backgroundColor=n?u:l,d.border="solid 1px",d.borderColor=l,d.height="20px",d.paddingLeft=ze,d.paddingRight=ze,d.textAlign="center",d.cursor="pointer",t instanceof HTMLAnchorElement&&(d.lineHeight="20px",d.display="inline-block",d.textDecoration="none"),p.verticalAlign="middle",p.height="16px",h.fontFamily="'Segoe UI', 'Segoe UI Web Regular', 'Helvetica Neue', 'BBAlpha Sans', 'S60 Sans', Arial, 'sans-serif'",h.fontSize="12px",h.fontWeight="bold",h.color=n?l:u,h.textAlign="center",h.verticalAlign="middle",h.marginLeft=o?Md:ke,h.marginRight=o?ke:Md}function Uf(e){var t=zd(e,!1);return"<button id='"+rd(t.buttonId)+"' title='"+rd(t.buttonTitle)+"'>"+t.innerHTML+"</button>"}function zd(e,t){var n=e[y],i=e[w],o=n===W,r=o?x.skyDriveOpenPickerButtonText:x.skyDriveSavePickerButtonText,a=i===Z?"SkyDriveIcon_white.png":"SkyDriveIcon_blue.png";return{innerHTML:"<img alt='' src='"+of()+"/SkyDrivePicker/"+a+"'>"+("<span>"+rd(r)+"</span>"),buttonTitle:o?x.skyDriveOpenPickerButtonTooltip:x.skyDriveSavePickerButtonTooltip,buttonId:o?t?"onedriveopenpickerbutton":"skydriveopenpickerbutton":t?"onedrivesavepickerbutton":"skydrivesavepickerbutton"}}function vg(e,t,n){var i=e.childNodes[0];if(t){var o=function(n){0!=e.childNodes.length?t(n):C(i,zb,o)};p(i,zb,o)}if(n){var r=!1,a=!1,s=function(e){a=!0,d(e)},c=function(e){a=!1,d(e)},l=function(e){r=!0,d(e)},u=function(e){r=!1,d(e)},d=function(){if(0==e.childNodes.length)return C(i,"mouseenter",s),C(i,"mouseleave",c),C(document,"mousedown",l),void C(document,"mouseup",u);n(r,a)};p(i,"mouseenter",s),p(i,"mouseleave",c),p(document,"mousedown",l),p(document,"mouseup",u)}}function Mi(e){var t=document.cookie;e+="=";var n=t.indexOf(e);if(n>=0){n+=e.length;var i=t.indexOf(";",n);if(i<0)i=t.length;else if(postCookie=t.substring(i),postCookie.indexOf(e)>=0)throw new Error(Rf);return t.substring(n,i)}return""}function Bf(e,t,n,i){var o=e+"="+(t=t||"")+"; path=/";if(n&&"localhost"!=n&&(o+="; domain="+encodeURIComponent(n)),null!=i){var r=new Date(0);i>0&&(r=new Date).setTime(r.getTime()+1e3*i),o+=";expires="+r.toUTCString()}a._isHttps&&a._secureCookie&&(o+=";secure"),document.cookie=o}pe.prototype={init:function(){var e=this;if(!0!==e._inited){e._inited=!0;try{var t=e._props,n=t[fb],i=t[r];t[f]="WL.ui-"+bc,e.validate(),t[w]=t[w]||qb,n=typeof n===b?gb(t[fb]):n,e._element=n,qf(n,Uf(t)),vg(n,g(e,e.onClick),g(e,e.onRender)),e.onRender(!1,!1),v(i,t,!1)}catch(e){k(e.message)}}},validate:function(){var e=this._props;h(e,[{name:fb,type:uc,optional:!1}],e[f])},onClick:function(){try{return a.fileDialog(this._props)}catch(e){k(e.message)}return!1},onRender:function(){Ed(this._props,this._element.childNodes[0])}};var Cb=function(e,t){this._cookieName=e,this._states=t||{},this._listeners=[],this._cookieWatcher=null};function bf(){return a._domain||window.location.hostname.split(":")[0]}Cb.prototype={getStates:function(){return this._states},get:function(e){return this._states[e]},set:function(e,t){this._states[e]=t},remove:function(e){this._states[e]&&delete this._states[e]},load:function(){try{var e=Mi(this._cookieName);if(this._rawValue!=e){i("Cookie changed: "+this._cookieName+"="+e),this._rawValue=e,this._states=Rb(e);for(var t=0;t<this._listeners.length;t++)this._listeners[t]()}}catch(e){k(e.message),this.stopMonitor()}},flush:function(e){this._states=e,this.save()},populate:function(e){q(e,this._states),this.save()},save:function(){Bf(this._cookieName,K(this._states),bf(),null)},clear:function(){this._states={},Bf(this._cookieName,"",bf(),0)},addCookieChanged:function(e){this._listeners.push(e),this.startMonitor()},startMonitor:function(){this._refreshInterval=300,this._cookieWatcher||(i("Started monitoring cookie: "+this._cookieName),this._cookieWatcher=window.setInterval(g(this,this.load),this._refreshInterval))},stopMonitor:function(){this._cookieWatcher&&(i("Stopped monitoring cookie: "+this._cookieName),window.clearInterval(this._cookieWatcher),this._cookieWatcher=null)},isBeingMonitored:function(){return null!==this._cookieWatcher}};var od=function(e,t,n){var i=this;i._method=e,i._completed=!1,i._requestFired=!1,i._properties=t,i._callback=n,i._authMonitor=g(i,i._onAuthChanged),i.execute=i._method==Fe?i._login:i._getLoginStatus};function Ni(e,t){var n,i,o=525,r=525;if(t&&(o=800,r=650),a._browser.ie){var s=window.screenLeft,c=window.screenTop,l=document.documentElement;i=s+Math.max(l.clientWidth-o,0)/2,n=c+Math.max(l.clientHeight-r,0)/2-30}else{var u=window.screenX,d=window.screenY,p=window.outerWidth,h=window.outerHeight;i=u+Math.max(p-o,0)/2,n=d+Math.max(h-r,0)/2}var f=["width="+o,"height="+r,"top="+n,"left="+i,"status=no","resizable=yes","toolbar=no","menubar=no","scrollbars=yes"],_=window.open(e,"oauth",f.join(","));return _.focus(),_}function Hh(e,t,n){var i={};i[qc]=Je,i[AK_REQUEST_TS]=n,i[AK_SECURE_COOKIE]=a._secureCookie,i[AK_DISPLAY]=rc,i[Vc]=Pd,a.trace&&(i[vc]=!0);var o=K(i),r={};r[AK_CLIENT_ID]=a._session.get(AK_CLIENT_ID),r[AK_RESPONSE_TYPE]=sb,r[AK_SCOPE]=t,r[AK_STATE]=o;var s=e.indexOf("?")>0;return e+(s?"&":"?")+K(r)}function mf(e,t,n,i,o,r){var s={};s[qc]=Je,s[AK_DISPLAY]=e,s[AK_REQUEST_TS]=i,o&&(s[AK_REDIRECT_URI]=window.location.href),a.trace&&(s[vc]=!0),r&&(s[Gi]=r);var c=e===rc?sb:a._response_type,l=c===sb?fe:Pd;s[Vc]=l,s[AK_SECURE_COOKIE]=a._secureCookie;var u=K(s),d={};return d[AK_CLIENT_ID]=a._session.get(AK_CLIENT_ID),d[AK_DISPLAY]=e,d[AK_LOCALE]=a._locale,d[AK_REDIRECT_URI]=n,d[AK_RESPONSE_TYPE]=c,d[AK_SCOPE]=t,d[AK_STATE]=u,"https://"+Qe()+"/oauth20_authorize.srf?"+K(d)}function Xc(e){var t=null!=e?e[AK_REDIRECT_URI]:null;return null!=t&&""!=t?t:a._redirect_uri}od.prototype={cancel:function(){this._onComplete({error:xb,error_description:Kg})},_login:function(){var e=this;e._requestTs=(new Date).getTime();var t=a._browser.mobile,n=t&&a._browser.ie,o=mf(t?kd:nf,e._properties.normalizedScope,Xc(e._properties),e._requestTs,n,e._properties.state);return n?document.location=o:(e._popup=Ni(o,e._properties.external_consent),i("AuthRequest-login: popup is opened. "+e._popup),e._popupWatcher=window.setInterval(g(e,e._checkPopup),3e3),c.subscribe(Vb,e._authMonitor)),e._promise=new l(L,null,null),e._promise},_getLoginStatus:function(){return Ch(g(this,this._fireStatusRequest)),this._timeout=window.setTimeout(g(this,this._onTimedOut),Ng),this._promise=new l("WL.getLoginStatus",null,null),this._promise},_fireStatusRequest:function(){var e=this;if(!e._requestFired){e._requestTs=(new Date).getTime();var t=a._refreshType===Uc?mf(rc,a._authScope,Xc(),e._requestTs,!1):Hh(Xc(),a._authScope,e._requestTs);e._statusFrame=Ge(t),c.subscribe(Vb,e._authMonitor),e._requestFired=!0}},_onAuthChanged:function(){var e=a._session.tryGetResponse(this._properties.normalizedScope,this._requestTs,this._properties.external_consent);null!=e&&this._onComplete(this._normalizeResp(e))},_normalizeResp:function(e){return this._method===Wd&&e.error===ab?a._session.getNormalStatus():e},_onTimedOut:function(){this._onComplete({error:kc,error_description:Ag})},_checkPopup:function(){try{null===this._popup?this._onComplete({error:ab,error_description:Xg}):this._popup.closed&&(this._popup=null)}catch(e){i("AuthRequest-checkPopup-error: "+e)}},_onComplete:function(e){this._completed||(this._completed=!0,this._dispose(),this._callback(this._properties,e),e[AK_ERROR]?this._promise[o](e):this._promise[n](e))},_dispose:function(){i("AuthRequest: dispose "+this._method),this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),null!=this._statusFrame&&(document.body.removeChild(this._statusFrame),this._statusFrame=null),this._popupWatcher&&(window.clearInterval(this._popupWatcher),this._popupWatcher=null),c.unsubscribe(Vb,this._authMonitor)}};var sf=function(e,t){this._state={},this._state[AK_CLIENT_ID]=e,this._state[AK_STATUS]=R,this._cookieName=t,this.init()};function Xe(e,t){if(null==t||""==U(t))return!0;for(var n=t.split(bi),i=0;i<n.length;i++){var o=U(n[i]);if(""!=o&&!Ai(e,o))return!1}return!0}function Ic(e){return e===R?Db:e===tc?D:e}function Yh(e){if((e._properties[bb]||!bh(e))&&!wh(e)&&!ah(e)){var t={};t[jc]=z,t[Zb]=Xd,e.onCompleted(t)}}function Oi(){return window.XMLHttpRequest&&void 0!==(new XMLHttpRequest).withCredentials}function Qe(){return a[oc]}function bd(e){return e?a[hc]:a[wb]}function ng(e){h(e,[{name:s,type:b,optional:!1}],e[f])}function oi(e){var t=e._properties[s];ch(t,e)}sf.prototype={get:function(e){return this._state[e]},save:function(){this._stateDirty&&(this._cookie.flush(this._state),this._stateDirty=!1)},init:function(){var e=new Cb(this._cookieName);e.load(),this._cookie=e,e.get(AK_CLIENT_ID)!=this._state[AK_CLIENT_ID]?(e.clear(),e.flush(this._state)):this._state=e.getStates();var t=this._state[AK_STATUS];this._statusChecked=t!==Db&&t!==R,this._cookie.addCookieChanged(g(this,this.onCookieChanged))},refresh:function(){a.getLoginStatus({internal:!0},!0),this._refresh=void 0},scheduleRefresh:function(){this.cancelRefresh();var e=1e3*(this.tokenExpiresIn()-600);e>0&&(this._refresh=window.setTimeout(g(this,this.refresh),e))},cancelRefresh:function(){this._refresh&&(window.clearTimeout(this._refresh),this._refresh=void 0)},updateStatus:function(e){var t=this._state[AK_STATUS],n=this._state[d];t!=e&&(this._state[AK_STATUS]=e,this._stateDirty=!0,this.onStatusChanged(t,e),this.save(),n!=this._state[d]&&c.notify(X,this.getNormalStatus()))},onStatusChanged:function(e,t){if(i("AuthSession: Auth status changed: "+e+"=>"+t),e!=t){var n=e==D,o=t==D;if(!o){for(var r=0;r<ic.length;r++){var a=ic[r];this._state[a]&&delete this._state[a]}this._stateDirty=!0,this.save()}Ic(e)!=Ic(t)&&c.notify(Hc,this.getNormalStatus()),o!=n&&(o?c.notify(cc,this.getNormalStatus()):c.notify(Zc,this.getNormalStatus()))}},isSignedIn:function(){return this._state[AK_STATUS]===D},getNormalStatus:function(){var e=this.getStatus();return e[AK_STATUS]=Ic(e[AK_STATUS]),e},tokenExpiresIn:function(){var e=this._state,t=e[AK_STATUS],n=parseInt(e[AK_EXPIRES]);return t===D?n-Re():-1},onCookieChanged:function(){var e=this._state,t=this._cookie.getStates();this._state=t,i("AuthSession: cookie changed. Has token: "+(null!=t[d])),this._statusChecked=t[AK_STATUS]!==R,e[d]==t[d]&&e[AK_ERROR]==t[AK_ERROR]&&e[AK_REQUEST_TS]==t[AK_REQUEST_TS]||(c.notify(Vb),delete t[AK_ERROR],delete t[AK_ERROR_DESC],this._stateDirty=!0),e[AK_STATUS]!=t[AK_STATUS]&&this.onStatusChanged(e[AK_STATUS],t[AK_STATUS]),e[d]!=t[d]&&(c.notify(X,this.getNormalStatus()),t[d]?this.scheduleRefresh():this.cancelRefresh()),this.save()},getStatus:function(){var e=null,t=this._state[AK_STATUS],n=null,i=null,o=null,r=null;if(t===D){var s=this.tokenExpiresIn();if(s<=10)t=this._statusChecked?Db:R,this.updateStatus(t),window.setTimeout((function(){a.getLoginStatus({internal:!0},!0)}),3e4);else{s<60&&(t=tc),(e={})[d]=this._state[d],e[AK_AUTH_TOKEN]=this._state[AK_AUTH_TOKEN];var c=this._state[AK_SCOPE].split(" ");e[AK_SCOPE]=[];for(var l=0;l<c.length;l++){var u=vh.exec(c[l]);if(u){var p=u[1].split("_"),h=p[0],f=p[1],_=f.indexOf("!"),m=f.substring(0,_),g=f.substring(_);n=[h,i=Li(m),o=i+g].join("."),r=u[2]}else e[AK_SCOPE].push(c[l])}this._state[AK_SCOPE]=e[AK_SCOPE].join(" "),e[AK_EXPIRES_IN]=s,e[AK_EXPIRES]=this._state[AK_EXPIRES]}}else this._statusChecked||(t=R);return{status:t,session:e,resource_id:n,owner_cid:i,item_id:o,authentication_key:r}},tryGetResponse:function(e,t,n){i("AuthSession.tryGetResponse: requestTs = "+t+" scope = "+e);var o=this.getStatus(),r=o[AK_STATUS],a=(o[AK_RESOURCEID],o[AK_SESSION]);if(r==R||r==tc)return null;if(void 0===t)return e?a&&Xe(a[AK_SCOPE],e)?o:null:o;var s=this._state,c=parseInt(s[AK_REQUEST_TS]),l=s[AK_ERROR],u=s[AK_ERROR_DESC];if(c>=t){if(a&&(!l&&n||Xe(a[AK_SCOPE],e)))return o;if(l)return mi(l,u);if(!e)return o}return null}};var ch=function(){var e=null;return function(t){var n={};if(n[Fi]=1,t=he(t,n),null===e){var i=Oc();e=Ge(t,i)}else e.src=t}}();function bh(e){var t=document.getElementsByTagName("HEAD")[0],n=document.createElement("SCRIPT"),i=Ne(e._properties,i,[r,s]),o=e._id,c=a.getAccessTokenForApi();null!=c&&(i[d]=c),i[r]=Jf+o,i[ge]="true";var l=A(e._url,i);return!(l.length>ye)&&(e.scriptTag=n,a.jsonp[o]=function(t){Qc(o,n),e.onCompleted(t)},Gh(n,e),n.setAttribute("async","async"),n.type="text/javascript",n.src=l,t.appendChild(n),window.setTimeout((function(){e._completed||Qc(o,n)}),3e4),!0)}function Gh(e,t){a._browser.ie&&e.attachEvent?e.attachEvent("onreadystatechange",(function(e){id(e,t)})):(e.readyState="complete",e.addEventListener("load",(function(e){id(e,t)}),!1),e.addEventListener("error",(function(e){id(e,t)}),!1))}function id(e,t){if(!t._completed){var n=e.srcElement||e.currentTarget;if(n.readyState||(n=e.currentTarget),"complete"==n.readyState||"loaded"==n.readyState){var i=t._id;if(failure="error"==e.type||null!=a.jsonp[i],failure){Qc(i,t.scriptTag);var o={};o[jc]=Jg,o[Zb]=be,t.onCompleted({error:o})}}}}function Qc(e,t){delete a.jsonp[e],document.getElementsByTagName("HEAD")[0].removeChild(t)}function ah(e){return Ii(),!(a._browser.flashVersion<9)&&(a.xdrFlash.send(e),!0)}function ni(e){return e?e.replace(/\r/g," ").replace(/\n/g," "):e}a.jsonp={},WL.Internal.jsonp=a.jsonp,a.xdrFlash={_id:"",_status:ad,_flashObject:null,_requests:{},_pending:[],init:function(){if(this._status==ad){this._status=sg;var e=Ub("div");e.id="wl_xdr_container",document.body.appendChild(e),this._id=Oc();var t=Mg,n=a[T]+"XDR.swf";t=(t=(t=t.replace(/{url}/g,n)).replace(/{id}/g,this._id)).replace(/{variables}/g,"domain="+document.domain),e.innerHTML=t}},onReady:function(e){for(e?(a._browser.firefox?this._flashObject=document.embeds[this._id]:this._flashObject=gb(this._id),this._status=Zd):this._status=Oh;this._pending.length>0;)this.send(this._pending.shift())},onRequestCompleted:function(e,t,n,i){var o=a.xdrFlash._requests[e];delete a.xdrFlash._requests[e],Yc(o,t,ni(n),i)},send:function(e){if(this._status<Zd)return this._pending.push(e),void(this._status==ad&&cb(g(this,this.init)));if(null!=this._flashObject){this._requests[e._id]=e;var t=Te(e);this.invoke("send",[e._id,t.url,t.method,t.body])}else Yc(e,0,null,yg)},invoke:function(d,a){a=a||[];var c=window.__flash__argumentsToXML(a,0),e='<invoke name="'+d+'" returntype="javascript">'+c+"</invoke>",b=this._flashObject.CallFunction(e);return null==b?null:eval(b)}},WL.Internal.xdrFlash=a.xdrFlash;var Mg="<object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' codebase='https://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0' width='300' height='300' id='{id}' name='{id}' type='application/x-shockwave-flash' data='{url}'><param name='movie' value='{url}'></param><param name='allowScriptAccess' value='always'></param><param name='FlashVars' value='{variables}'></param><embed play='true' menu='false' swLiveConnect='true' allowScriptAccess='always' type='application/x-shockwave-flash' FlashVars='{variables}' src='{url}' width='300' height='300' name='{id}'></embed></object>",Rc=null;!function(){a.fileDialog=function(e){if(B(e[f]),null!=a._pendingPickerOp)throw new Error(Ff);return new Rc(e).execute()};function e(e){var t=e[y]===W,n=t?If:Gf,i={},o=gf()+a[FILEDIALOG_PARAM_PICKER_SCRIPT];return"/"===o.charAt(0)&&(o=sc+o),i[rg]=n,i[hh]=a._rpsAuth?qg:gg,i[Lg]=window.location.hostname.toLowerCase(),i[Bg]=o,i[AK_CLIENT_ID]=a._appId,i[AK_REQUEST_TS]=(new Date).getTime(),i[qh]=a._locale,a._rpsAuth||(i[d]=e[d]),t&&(i[P]=e[P]),A(a[Ab],i)}function t(e,t){var n,i;if(a._browser.ie){var o=document.documentElement;n=(o.clientWidth-e)/2,i=(o.clientHeight-t)/2}else n=(window.innerWidth-e)/2,i=(window.innerHeight-t)/2;return{left:(n=n<10?10:n)+"px",top:(i=i<10?10:i)+"px"}}(Rc=function(e){var t=this;t._props=e,t._startTs=(new Date).getTime(),e[Lb]=e[Lb]||zc,e[P]=e[P]||V,t._state=0,t._authDelegate=g(t,t._onAuthResp),a._pendingPickerOp=t}).prototype={execute:function(){var e=this,t=new l(e._props[f],e,null);return e._promise=t,e._process(),t},cancel:function(e){var t=this;3!==t._state&&(e||(e=j(xb,ac.replace(m,t._props[f]))),t._onComplete(e))},_process:function(){var e=this;switch(e._state){case 0:e._validateAuth();break;case 1:e._initPicker();break;case 2:e._complete()}},_changeState:function(e,t){var n=this;3!==n._state&&n._state!==e&&(n._state=e,t&&(n._result=t),n._process())},_onComplete:function(e){this._changeState(2,e)},_validateAuth:function(){var e=this,t=!1;if(a._rpsAuth)e._changeState(1);else{var n;switch(e._props[y]){case W:n=yi;break;case Kb:n=mh;break;case pb:case ob:n=e._buildExternalScope(),t=!0;break;default:var i=Yd.replace(m,ub).replace(Eb,y);return void e._onComplete(j(gh,i))}var o=e._props[f];t?a.login({scope:n,external_consent:!0}).then((function(t){e._onExternalConsentComplete(t)}),(function(t){e._onComplete(t)})):(n+=" "+pf,a.ensurePermission(n,650,o,e._authDelegate))}},_buildExternalScope:function(){var e=this,t="onedrive_onetime.access:";switch(e._props[y]){case pb:t+=pb;break;case ob:t+=ob}switch(e._props[Hd]){case Hb:t+="file|";break;case Gb:t+="folder|";break;default:t+="file|"}return t+=e._props[P]===V?V:Bc,e._props[Mb]&&(t+="|"+e._props[Mb]),t},_onAuthResp:function(e){var t=this;if(e.error)t._channel||t._onComplete(e);else{var n=e.session[d];t._props[d]=n,t._channel?t._channel.send(FILEDIALOG_CHCMD_UPDATETOKEN,n):t._changeState(1)}},_initPicker:function(){var n=this,i=n._props;!function(n){var i=n[y]===W,o=i?800:500,r=i?600:450,a=n[Lb],s=a===yd?0:60,c=a===zc?"white":"rgb(0,0,0)",l=s/100,u=t(o,r),d=e(n),h=document.createElement("div");h.style.top="0px",h.style.left="0px",h.style.position="fixed",h.style.width="100%",h.style.height="100%",h.style.display="block",h.style.backgroundColor=c,h.style.opacity=l,h.style.MozOpacity=l,h.style.filter="alpha(opacity="+s+")",h.style.zIndex="2600000";var f=document.createElement("iframe");f.id="picker"+(new Date).getTime(),f.style.top=u.top,f.style.left=u.left,f.style.position="fixed",f.style.width=o+"px",f.style.height=r+"px",f.style.display="block",f.style.zIndex="2600001",f.style.borderWidth="1px",f.style.borderColor="gray",f.style.maxHeight="100%",f.style.maxWidth="100%",f.src=d,f.setAttribute("sutra","picker"),document.body.appendChild(f),document.body.appendChild(h),n.resizeHandler=function(){var e=t(o,r);f.style.top=e.top,f.style.left=e.left},p(window,"resize",n.resizeHandler),n.lightBox=h,n.frame=f,n.url=d}(i),n._channel=a.channel.registerOuterChannel(Hg,vd(i.url).host,i.frame.contentWindow,i.url,g(n,n._onMessage)),c.subscribe(X,n._authDelegate);var o=function(e){e.keyCode===Ji&&n.cancel()};i.keydownHandler=o,p(window,"keydown",o),n._initTimeout()},_initTimeout:function(){var e=this;timeoutSeconds=e._props[Dd],timeoutSeconds&&timeoutSeconds>0&&(e._timeout=window.setTimeout(g(e,e._onTimeout),1e3*timeoutSeconds))},_onTimeout:function(){var e=this;e._channel._connected||e.cancel(j(kc,og)),e._clearTimeout()},_clearTimeout:function(){var e=this;e._timeout&&(window.clearTimeout(e._timeout),e._timeout=void 0)},_complete:function(){var e=this,t=e._result,i=t.error?o:n;e._state=3,e._cleanup(),e._normalizeResp(),e._props[f]===ub?v(e._props[r],t,!0):t.data?v(e._props[Ld],t,!0):v(e._props[yb],t,!0),e._promise[i](t),a._rpsAuth||S((function(){e._report()}))},_report:function(){var e,t=this._props,n=this._result,i=((new Date).getTime()-this._startTs)/1e3,o=0,r=0;n.data&&(null!=n.data.folders&&(o=n.data.folders.length),null!=n.data.files&&(r=n.data.files.length)),e=o>0&&r>0?"both":o>0?Gb:r>0?Hb:"none";var s=o+r,c={client:bc,api:t[f],mode:t[y],select:t[P],result:n.error?n.error.code:"success",duration:i,object_selected:e,selected_count:s},l=a[Wb];a.api({path:"web_analytics",method:cd,body:c}),l&&l(c)},_onExternalConsentComplete:function(e){var t=this,n=t._props[Mb]===Ib;if(e.error)t._onComplete(e);else{var i=e[AK_OWNER_CID],o=e[AK_RESOURCEID],r=e[AK_ITEMID],c=e[Hi];if(o)if(c||!n){var l,u,d=a._browser.ie9,p=t._props[Rg],h={method:dc,interface_method:t._props[f]};if(d&&p)h[s]=o+"/files";else h[bb]=!0,h[Qd]=[{name:Lc,value:a._appId},{name:Fc,value:E("{0}={1}",Mc,a._settings.sdk_version)}],n?(l="drives/"+i+"/items/"+r+"?"+Of,u={authKey:c}):(l="drive/items/"+r+"/children?"+(p?ti:Qg),u={access_token:a.getAccessTokenForApi()}),h[s]=A(l,u);a.api(h).then((function(n){var i={pickerResponse:e,apiResponse:n};t._onComplete(i)}),(function(e){t._onComplete(e)}))}else t._onComplete(j(z,"Did not get expected auth key for the resource."));else t._onComplete(j(z,"Did not get expected resource id."))}},_onMessage:function(e,t){switch(nb(e),e){case FILEDIALOG_CHCMD_ONCOMPLETE:this._onComplete(t)}},_normalizeResp:function(){var e=this,t=e._result.data,n=e._result.error,i=function(e){var t=e.upload_location;t&&(e.upload_location=t.replace("WL_APISERVICE_URL",a[wb]))};if(t){if(t.folders)for(var o=0;o<t.folders.length;o++)i(t.folders[o]);if(t.files)for(o=0;o<t.files.length;o++)i(t.files[o])}n&&n.message&&(n.message=n.message.replace(m,e._props[f]))},_cleanup:function(){var e=this,t=e._props,n=e._channel,i=t.resizeHandler,o=t.keydownHandler;e._clearTimeout(),c.unsubscribe(X,e._authDelegate),t.lightBox&&(t.frame.style.display=We,t.lightBox.style.display=We,document.body.removeChild(t.frame),document.body.removeChild(t.lightBox),delete t.lightBox,delete t.frame),n&&(n.dispose(),delete e._channel),i&&C(window,"resize",i),o&&C(window,"keydown",o),delete a._pendingPickerOp}}}();var hf=6e4;function Nd(e,t,n){var i=this;i._op=e,i._iMethod=n,i._element=t,i._uploadIFrame=null,i._uploadTimeoutId=null,e.setFileName(void 0)}function Cd(){this._pendingUploads={}}fd.prototype._getStrategy=function(e){var t=this,n=e[f],i=e[Q],o=e[tb],r=e[bb];if(h(e,[{name:Q,type:uc,optional:!1}],n),typeof i===b&&(i=document.getElementById(i)),!(i instanceof HTMLInputElement)||i.type!==ud)throw O(Q,n,'It must be an HTMLInputElement with its type attribute set to"file" (i.e., <input type="file" />).');if(""===i.value)throw O(Q,n,"It did not contain a selected file.");if(i.files&&window.FileReader){if(1!==i.files.length)throw O(Q,n,"It must contain one selected file.");var a=i.files[0];if(a.size>Yg)throw O(Q,n,"Max supported file size for form uploads is 100MB.");var s=o||a.name;return t.setFileName(s),new di(t,a,r,s)}if(r)throw new Error(Vf);""===i.name&&(i.name=ud);var c=null;if(null===i.form?c="It must be a child of an HTMLFormElement.":1!==i.form.length?c="It must be the only HTMLInputElement in its parent HTMLFormElement.":i.name!==ud&&(c='Its name attribute must be set to "file" (i.e., <input name="file" />).'),null!==c)throw O(Q,n,c);return new Nd(t,i,n)},Nd.prototype={getId:function(){var e=this;return null===e._uploadIFrame&&e._createUploadIFrame(),e._uploadIFrame.id},setUploadTimeout:function(){var e=this;e._uploadTimeoutId=window.setTimeout((function(){e.onTimeout()}),hf)},clearUploadTimeout:function(){var e=this;null!==e._uploadTimeoutId&&(window.clearTimeout(e._uploadTimeoutId),e._uploadTimeoutId=null)},onTimeout:function(){var e=this;e._uploadTimeoutId=null;var t=e._iMethod+": did not receive a response in "+hf+" milliseconds.",n=j(kc,t);e._op.uploadComplete(!1,n)},onUploadComplete:function(e){var t=this;t.clearUploadTimeout(),t._removeUploadIFrame();var n=typeof(e=ed(e)).error===hb;t._op.uploadComplete(n,e)},upload:function(e){this._multiPartFormUpload(e)},_getRequestUrl:function(e){var t={};t[AK_REDIRECT_URI]=a._redirect_uri;var n={};return n[qc]=ue,n[df]=this.getId(),t[AK_STATE]=K(n),A(e,t)},_createUploadIFrame:function(){var e=this;null===e._uploadIFrame&&(e._uploadIFrame=Ub("iframe"),e._uploadIFrame.name=e._uploadIFrame.id=Oc(),document.body.appendChild(e._uploadIFrame))},_multiPartFormUpload:function(e){var t=this;t._createUploadIFrame();var n=t._getRequestUrl(e);t._submitForm(n),t.setUploadTimeout(),vb.add(t),Cg()},_removeUploadIFrame:function(){var e=this;null!==e._uploadIFrame&&(e._uploadIFrame.parentNode.removeChild(e._uploadIFrame),e._uploadIFrame=null)},_submitForm:function(e){var t=this._element.form;t.target=this._uploadIFrame.name,t.method=cd,t.enctype="multipart/form-data",t.action=e,t.submit()}},Cd.prototype={add:function(e){var t=e.getId();this._pendingUploads[t]=e},hasPendingUploads:function(){for(var e in this._pendingUploads)return!0;return!1},isPending:function(e){return e in this._pendingUploads},get:function(e){return this._pendingUploads[e]},remove:function(e){delete this._pendingUploads[e]}};var vb=new Cd,Cg=function(){var e=!1,t=new Cb(kf),n=function(){var e=t.getStates(),n=!1;for(var i in e)if(vb.isPending(i)){var o=e[i],r=vb.get(i);vb.remove(i),t.remove(i),n=!0,r.onUploadComplete(o)}vb.hasPendingUploads()||t.stopMonitor(),n&&(t.save(),n=!1)};return function(){t.isBeingMonitored()||(e?t.startMonitor():(t.addCookieChanged(n),e=!0))}}();function di(e,t,n,i){this.upload=function(o){var r=null;window.File&&t instanceof window.File&&(r=new FileReader),r.onerror=function(t){error=t.target.error,e.onErr(error.name)},r.onload=function(t){var r=t.target.result,s=new XMLHttpRequest;n&&(o=E(o,i)),s.open(qi,o,!0),n&&(s.setRequestHeader(ne,"text/plain"),s.setRequestHeader(Lc,a._appId),s.setRequestHeader(Fc,E("{0}={1}",Mc,a._settings.sdk_version))),s.onload=function(t){e.onResp(t.currentTarget.responseText)},s.onerror=function(t){e.onErr(t.currentTarget.statusText)},s.upload&&(s.upload.onprogress=function(t){if(t.lengthComputable){var n={bytesTransferred:t.loaded,totalBytes:t.total,progressPercentage:0===t.total?0:t.loaded/t.total*100};e.uploadProgress(n)}}),e._cancel=g(s,s.abort),s.send(r)},r.readAsArrayBuffer(t)}}function Tg(){a._isHttps=document.location.protocol.toLowerCase()==sc}function Ii(){if(void 0===a._browser.flash){var e=0;try{if(a._browser.ie)e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7").GetVariable("$version").split(" ")[1].split(",")[0];else if(navigator.plugins&&navigator.plugins.length>0&&(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])){var t=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";e=navigator.plugins["Shockwave Flash"+t].description.split(" ")[2].split(".")[0]}}catch(e){}a._browser.flashVersion=e,a._browser.flash=e>=8}}function ri(){void 0===a._documentReady&&(a._documentReady=(new Date).getTime())}function Ch(e){cb((function(){a._browser.firefox&&(!a._documentReady||(new Date).getTime()-a._documentReady<1e3)?window.setTimeout(e,1e3):e()}))}function cb(e){if(document.body)switch(document.readyState){case"complete":return void e();case"loaded":if(a._browser.webkit)return void e();break;case"interactive":case void 0:if(a._browser.firefox||a._browser.webkit)return void e()}document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),document.addEventListener("load",e,!1)):window.attachEvent&&window.attachEvent("onload",e),a._browser.ie&&document.attachEvent&&document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),e())}))}function qf(e,t){e.innerHTML=t}function p(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function C(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function Ph(){var e=gb(qd);if(e){var t=e.getAttribute(Oe);return!t&&k(E("Could not find attribute '{0}' on element with id '{1}'.",Oe,qd),fc),t}return k(E("Could not find element with id '{0}'.",qd),fc),null}var gd={registerOuterChannel:function(e,t,n,i,o){return F.registerChannel(e,t,n,i,o)},registerInnerChannel:function(e,t,n){return F.registerChannel(e,t,null,null,n)},isSupported:function(){return F.isSupported()}},F={_channels:[],isSupported:function(){return null!=window.postMessage},registerChannel:function(e,t,n,i,o){var r=F,a=r._channels,s=null;return r.isSupported()&&(s=new Ie(e,t,n,i,o),0===a.length&&p(window,"message",r._onMessage),a.push(s)),s},unregisterChannel:function(e){for(var t=F,n=t._channels,i=0;i<n.length;i++)if(n[i]==e){n.splice(i,1);break}0===n.length&&C(window,"message",t._onMessage)},_onMessage:function(e){var t=F,n=si(e=e||window.event);if(null!=n){var i=t._findChannel(e,n);if(null!=i)switch(n.text){case uf:i._onConnectReq(e.source,e.origin);break;case tf:i._onConnectAck(e.source);break;default:i._onMessage(n.text)}}},_findChannel:function(e,t){for(var n=F._channels,i=Ci(e.origin),o=0;o<n.length;o++){var r=n[o];if(Td(r._name,t.name)&&Td(r._allowedDomain,i))return r}return null}},uf="@ConnectReq",tf="@ConnectAck";function Ie(e,t,n,i,o){var r=this;r._name=e,r._allowedDomain=t,r._msgHandler=o,n&&(r._targetWindow=n,r._targetUrl=pi(i),r._connect())}function pi(e){var t=e.indexOf("://");return t>=0&&(t=e.indexOf("/",t+3))>=0&&(e=e.substring(0,t)),e}function si(e){var t=null;return Ce(e.origin)||Ce(e.data)||null==e.source||(t=Wh(e.data)),t}function Xh(e,t){return"<"+e+">"+t}function Wh(e){var t=null;if("<"==e.charAt(0)){var n=e.indexOf(">");if(n>0)t={name:e.substring(1,n),text:e.substr(n+1)}}return t}function oh(e,t){var n={cmd:e,args:t};return JSON.stringify(n)}function nh(e){return JSON.parse(e)}Ie.prototype={_disposed:!1,_connected:!1,_allowedDomain:null,_targetWindow:null,_targetUrl:null,_msgHandler:null,_connectSchedule:-1,_pendingQueue:[],_recvQueue:[],dispose:function(){var e=this;e._disposed||(e._disposed=!0,e._cancelConnect(),F.unregisterChannel(e))},send:function(e,t){var n=this;if(!n._disposed){var i=oh(e,t);n._connected?n._post(i):n._pendingQueue.push(i)}},_connect:function(){var e=this;if(!e._disposed&&!e._connected){var t=function(){e._post(uf)};-1===e._connectSchedule&&(e._connectSchedule=window.setInterval(t,500),t())}},_post:function(e){var t=this,n=Xh(t._name,e);t._targetWindow.postMessage(n,t._targetUrl)},_onConnectReq:function(e,t){var n=this;n._connected||(n._connected=!0,n._targetWindow=e,n._targetUrl=t,n._post(tf),n._onConnected())},_onConnectAck:function(e){var t=this;t._connected||(t._targetWindow=e,t._onConnected())},_onConnected:function(){var e=this,t=e._pendingQueue;e._connected=!0;for(var n=0;n<t.length;n++)e._post(t[n]);e._pendingQueue=[],e._cancelConnect()},_cancelConnect:function(){var e=this;-1!=e._connectSchedule&&(window.clearInterval(e._connectSchedule),e._connectSchedule=-1)},_onMessage:function(e){if(this._msgHandler){var t=nh(e);this._msgHandler(t.cmd,t.args)}}},window.WL?a.channel=gd:window.WL={channel:gd};var x={connect:"Connect",signIn:"Sign in",signOut:"Sign out",login:"Log in",logout:"Log out",skyDriveOpenPickerButtonText:"Open from OneDrive",skyDriveOpenPickerButtonTooltip:"Open from OneDrive",skyDriveSavePickerButtonText:"Save to OneDrive",skyDriveSavePickerButtonTooltip:"Save to OneDrive"};a._locale="en",a[N]="Web/DEVICE_"+dh("5.5.2504.3000"),a.testInit=function(e){e.env&&a._settings.init(e.env),e.skydrive_uri&&(a._settings[Ab]=e.skydrive_uri),e[Wb]&&(a[Wb]=e[Wb])};var ib={};ib[oc]="login.live.com",ib[wb]="https://apis.live.net/v5.0/",ib[Ab]="https://onedrive.live.com/",ib[T]="//js.live.net/v5.0/",ib[hc]="https://api.onedrive.com/v1.0/";var mb={};mb[oc]="login.live.com",mb[wb]="https://apis.live.net/v5.0/",mb[Ab]="https://onedrive.live.com/",mb[T]="//df-js.live.net/v5.0/",mb[hc]="https://df.api.onedrive.com/v1.0/";var kb={};kb[oc]="login.live-int.com",kb[wb]="https://apis.live-int.net/v5.0/",kb[Ab]="https://onedrive.live-int.com/",kb[T]="//js.live-int.net/v5.0/",kb[hc]="https://newapi.storage.live-int.com/v1.0/",a._settings={sdk_version:"js-v1.0",PROD:ib,DF:mb,INT:kb,init:function(e){var t=this[e=e.toUpperCase()];t&&q(t,a)}},a._settings.init("PROD"),a[FILEDIALOG_PARAM_PICKER_SCRIPT]="wl.skydrivepicker.js",a.onloadInit(),t.onloadInit()}}(),module.exports=WL}}]);